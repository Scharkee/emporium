!function(){var t=function(t){var e={exports:{}};return t.call(e.exports,e,e.exports),e.exports},e=(window,function(){function t(t,e){var n=[],r=!0,o=!1,i=undefined;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done)&&(n.push(u.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),n=function(t){return t&&t.__esModule?t:{"default":t}},r=t(function(t){(function(){var e=[].slice;!function(e,n){"function"==typeof e.define&&e.define.amd?e.define([],n):t.exports?t.exports=n():e.Twine=n()}(this,function(){var t,n,r,o,i,u,a,s,l,c,f,h,d,p,v,g,m,b,y,w,T,E,A,x,S,k,G,C,P,O,L,N,R,_,q,H,I,F,D,M;for(t={},t.shouldDiscardEvent={},s={},L={},S=0,R=null,T=/^[a-z]\w*(\.[a-z]\w*|\[\d+\])*$/i,O=!1,_=null,u=null,t.getAttribute=function(t,e){return t.getAttribute("data-"+e)||t.getAttribute(e)},t.reset=function(t,e){var n,r,o,i,u,a;null==e&&(e=document.documentElement);for(o in s)if(n=null!=(a=s[o])?a.bindings:void 0)for(r=0,i=n.length;r<i;r++)u=n[r],u.teardown&&u.teardown();return s={},R=t,_=e,_.bindingId=S=1,this},t.bind=function(e,n){return null==e&&(e=_),null==n&&(n=t.context(e)),o(n,e,d(e),!0)},t.afterBound=function(t){return u?u.push(t):t()},o=function(e,n,r,s){var l,f,h,d,g,m,b,y,T,E,A,x,k,G,C,P,O,L,N,_,$,H,I,F,D,M,K,U;if(u=[],T=null,n.bindingId&&t.unbind(n),b=t.getAttribute(n,"define-array")){$=a(n,e,b),null==r&&(r={});for(x in r)U=r[x],$.hasOwnProperty(x)||($[x]=U);r=$,T=c(n),T.indexes=r}for(h=null,H=n.attributes,E=0,C=H.length;E<C;E++)l=H[E],K=l.name,v(K)&&(K=K.slice(5)),(m=t.bindingTypes[K])&&(null==h&&(h=[]),y=l.value,h.push([K,m,y]));if(h)for(null==T&&(T=c(n)),null==T.bindings&&(T.bindings=[]),null==T.indexes&&(T.indexes=r),I=h.sort(i),A=0,P=I.length;A<P;A++)F=I[A],F[0],m=F[1],y=F[2],(f=m(n,e,y,T))&&T.bindings.push(f);for((_=t.getAttribute(n,"context"))&&(k=w(n,_),"$root"===k[0]&&(e=R,k=k.slice(1)),e=p(e,k)||q(e,k,{})),(T||_||s)&&(null==T&&(T=c(n)),T.childContext=e,null!=r&&null==T.indexes&&(T.indexes=r)),d=u,D=n.children||[],G=0,O=D.length;G<O;G++)g=D[G],o(e,g,null!=_?null:r);for(t.count=S,M=d||[],N=0,L=M.length;N<L;N++)(0,M[N])();return u=null,t},c=function(t){var e;return null==t.bindingId&&(t.bindingId=++S),null!=s[e=t.bindingId]?s[e]:s[e]={}},t.refresh=function(){if(!O)return O=!0,setTimeout(t.refreshImmediately,0)},P=function(t){var e,n,r,o;if(t.bindings)for(o=t.bindings,e=0,n=o.length;e<n;e++)r=o[e],null!=r.refresh&&r.refresh()},t.refreshImmediately=function(){var t,e;O=!1;for(e in s)t=s[e],P(t)},t.register=function(t,e){if(L[t])throw new Error("Twine error: '"+t+"' is already registered with Twine");return L[t]=e},t.change=function(t,e){var n;return null==e&&(e=!1),n=document.createEvent("HTMLEvents"),n.initEvent("change",e,!0),t.dispatchEvent(n)},t.unbind=function(e){var n,r,o,i,u,a,l,c,f,h;if(o=e.bindingId){if(n=null!=(f=s[o])?f.bindings:void 0)for(i=0,a=n.length;i<a;i++)c=n[i],c.teardown&&c.teardown();delete s[o],delete e.bindingId}for(h=e.children||[],u=0,l=h.length;u<l;u++)r=h[u],t.unbind(r);return this},t.context=function(t){return h(t,!1)},t.childContext=function(t){return h(t,!0)},h=function(t,e){for(var n,r,o;t;){if(t===_)return R;if(e||(t=t.parentNode),!t)return console.warn("Unable to find context; please check that the node is attached to the DOM that Twine has bound, or that bindings have been initiated on this node's DOM"),null;if((r=t.bindingId)&&(n=null!=(o=s[r])?o.childContext:void 0))return n;e&&(t=t.parentNode)}},d=function(t){var e,n;for(null;t;){if(e=t.bindingId)return null!=(n=s[e])?n.indexes:void 0;t=t.parentNode}},t.contextKey=function(t,e){var n,r,o,i,u;for(i=[],n=function(t){var n,r;for(n in t)if(r=t[n],e===r){i.unshift(n);break}return e=t};t&&t!==_&&(t=t.parentNode);)(o=t.bindingId)&&(r=null!=(u=s[o])?u.childContext:void 0)&&n(r);return t===_&&n(R),i.join(".")},D=function(t){var e,n;return e=t.nodeName.toLowerCase(),"input"===e||"textarea"===e||"select"===e?"checkbox"===(n=t.getAttribute("type"))||"radio"===n?"checked":"value":"textContent"},w=function(t,e){var n,r,o,i,u,a,s;for(i=[],a=e.split("."),r=o=0,u=a.length;o<u;r=++o)if(e=a[r],-1!==(s=e.indexOf("[")))for(0===r?i.push.apply(i,y(e.substr(0,s),t)):i.push(e.substr(0,s)),e=e.substr(s);-1!==(n=e.indexOf("]"));)i.push(parseInt(e.substr(1,n),10)),e=e.substr(n+1);else 0===r?i.push.apply(i,y(e,t)):i.push(e);return i},y=function(t,e){var n,r,o;return n=null!=(r=s[e.bindingId])&&null!=(o=r.indexes)?o[t]:void 0,null!=n?[t,n]:[t]},p=function(t,e){var n,r,o;for(n=0,o=e.length;n<o;n++)r=e[n],null!=t&&(t=t[r]);return t},q=function(t,n,r){var o,i,u,a,s,l;for(l=n,n=2<=l.length?e.call(l,0,o=l.length-1):(o=0,[]),a=l[o++],i=0,s=n.length;i<s;i++)u=n[i],t=null!=t[u]?t[u]:t[u]={};return t[a]=r},F=function(t){return[].map.call(t.attributes,function(t){return t.name+"="+JSON.stringify(t.value)}).join(" ")},M=function(t,e,n){var r;if(g(t)&&(r=w(n,t)))return"$root"===r[0]?function(t,e){return p(e,r)}:function(t){return p(t,r)};t="return "+t,x(n)&&(t="with($arrayPointers) { "+t+" }"),N(e)&&(t="with($registry) { "+t+" }");try{return new Function(e,"with($context) { "+t+" }")}catch(t){throw t,"Twine error: Unable to create function on "+n.nodeName+" node with attributes "+F(n)}},N=function(t){return/\$registry/.test(t)},x=function(t){var e;return null!=t.bindingId&&(null!=(e=s[t.bindingId])?e.indexes:void 0)},n=function(t,e){var n,r,o,i;if(!(r=x(t)))return{};i={};for(o in r)n=r[o],i[o]=e[o][n];return i},g=function(t){return"true"!==t&&"false"!==t&&"null"!==t&&"undefined"!==t&&T.test(t)},v=function(t){return"d"===t[0]&&"a"===t[1]&&"t"===t[2]&&"a"===t[3]&&"-"===t[4]},f=function(t){var e;return e=document.createEvent("CustomEvent"),e.initCustomEvent("bindings:change",!0,!1,{}),t.dispatchEvent(e)},i=function(t,e){var n,r,o;return r=t[0],o=e[0],n={define:1,bind:2,eval:3},n[r]?n[o]?n[r]-n[o]:-1:1},t.bindingTypes={bind:function(e,r,o){var i,u,a,s,l,c,h,d,v,m,b;return b=D(e),m=e[b],l=void 0,d=void 0,u="radio"===e.getAttribute("type"),a=M(o,"$context,$root,$arrayPointers",e),c=function(){var t;if((t=a.call(e,r,R,n(e,r)))!==l&&(l=t,t!==e[b]))return e[b]=u?t===e.value:t,f(e)},g(o)?(h=function(){if(u){if(!e.checked)return;return q(r,s,e.value)}return q(r,s,e[b])},s=w(e,o),v="textContent"!==b&&"hidden"!==e.type,"$root"===s[0]&&(r=R,s=s.slice(1)),null==m||!v&&""===m||null!=p(r,s)||h(),v&&(i=function(){if(p(r,s)!==this[b])return h(),t.refreshImmediately()},$(e).on("input keyup change",i),d=function(){return $(e).off("input keyup change",i)}),{refresh:c,teardown:d}):{refresh:c}},"bind-show":function(t,e,r){var o,i;return o=M(r,"$context,$root,$arrayPointers",t),i=void 0,{refresh:function(){var r;if((r=!o.call(t,e,R,n(t,e)))!==i)return $(t).toggleClass("hide",i=r)}}},"bind-class":function(t,e,r){var o,i;return o=M(r,"$context,$root,$arrayPointers",t),i={},{refresh:function(){var r,u,a;u=o.call(t,e,R,n(t,e));for(r in u)a=u[r],!i[r]!=!a&&$(t).toggleClass(r,!!a);return i=u}}},"bind-attribute":function(t,e,r){var o,i;return o=M(r,"$context,$root,$arrayPointers",t),i={},{refresh:function(){var r,u,a;u=o.call(t,e,R,n(t,e));for(r in u)a=u[r],i[r]!==a&&$(t).attr(r,a||null);return i=u}}},define:function(t,e,r){var o,i,u,a;o=M(r,"$context,$root,$registry,$arrayPointers",t),u=o.call(t,e,R,L,n(t,e));for(i in u)a=u[i],e[i]=a},eval:function(t,e,r){var o;o=M(r,"$context,$root,$registry,$arrayPointers",t),o.call(t,e,R,L,n(t,e))}},a=function(t,e,n){var r,o,i,u,a;r=M(n,"$context,$root",t),u=r.call(t,e,R),o={};for(i in u){if(a=u[i],null==e[i]&&(e[i]=[]),!(e[i]instanceof Array))throw"Twine error: expected '"+i+"' to be an array";o[i]=e[i].length,e[i].push(a)}return o},I=function(e,r){var o;return o="checked"===e||"indeterminate"===e||"disabled"===e||"readOnly"===e||"draggable"===e,t.bindingTypes["bind-"+r.toLowerCase()]=function(t,r,i){var u,a;return u=M(i,"$context,$root,$arrayPointers",t),a=void 0,{refresh:function(){var i;if(i=u.call(t,r,R,n(t,r)),o&&(i=!!i),i!==a)return t[e]=a=i,"checked"===e?f(t):void 0}}}},G=["placeholder","checked","indeterminate","disabled","href","title","readOnly","src","draggable"],m=0,E=G.length;m<E;m++)r=G[m],I(r,r);for(I("innerHTML","unsafe-html"),k=function(e){var n;return!("submit"!==e.type&&"a"!==e.currentTarget.nodeName.toLowerCase()||"false"!==(n=t.getAttribute(e.currentTarget,"allow-default"))&&!1!==n&&0!==n&&void 0!==n&&null!==n)},H=function(e){return t.bindingTypes["bind-event-"+e]=function(r,o,i){var u;return u=function(u,a){var s,l;if(l="function"==typeof(s=t.shouldDiscardEvent)[e]?s[e](u):void 0,(l||k(u))&&u.preventDefault(),!l)return M(i,"$context,$root,$arrayPointers,event,data",r).call(r,o,R,n(r,o),u,a),t.refreshImmediately()},$(r).on(e,u),{teardown:function(){return $(r).off(e,u)}}}},C=["click","dblclick","mouseenter","mouseleave","mouseover","mouseout","mousedown","mouseup","submit","dragenter","dragleave","dragover","drop","drag","change","keypress","keydown","keyup","input","error","done","success","fail","blur","focus","load","paste"],b=0,A=C.length;b<A;b++)l=C[b],H(l);return t})}).call(this)});t(function(){window.Twine=r}),t(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=window.Twine,window.Bindings=null!=e["default"]?e["default"]:e}),t(function(t,r){"use strict";function o(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:function(){return{}};h=t}function i(t){try{location.href!==l&&(c={});var n=void 0;if(null!=h&&(n=h()||{},s["default"].reset(n),t||s["default"].bind(),h=null),t){var r=!0,o=!1,i=undefined;try{for(var u,a=t[Symbol.iterator]();!(r=(u=a.next()).done);r=!0){var d=u.value;s["default"].bind(d)}}catch(t){o=!0,i=t}finally{try{!r&&a["return"]&&a["return"]()}finally{if(o)throw i}}}var p=!0,v=!1,g=undefined;try{for(var m,b=f[Symbol.iterator]();!(p=(m=b.next()).done);p=!0){var y=e(m.value,2),w=y[0];(0,y[1])(w)}}catch(t){v=!0,g=t}finally{try{!p&&b["return"]&&b["return"]()}finally{if(v)throw g}}f.length=0,s["default"].refreshImmediately(),n&&"function"==typeof n.pageLoaded&&n.pageLoaded()}catch(t){throw t}}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=o;var u=n($),a=n(_),s=n(Twine),l=location.href,c={},f=[],h=void 0;o.getLastUrl=function(){return l},o.onRefresh=function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];var o=void 0,i=void 0;n[1]?(o=n[0],i=n[1]):i=n[0],o&&s["default"].afterBound(function(){var e=s["default"].contextKey(o,t),n=c[e];n&&f.push([n,i]),c[e]=t})},o.pushState=function(t){window.history.pushState({turbolinks:!0,url:t},null,t)},o.replaceState=function(t){window.history.replaceState({turbolinks:!0,url:t},null,t)},o.openPopup=function(t,e,n){var r={width:500,height:500,directories:"no",location:"no",menubar:"no",resizeable:"yes",scrollbars:"yes",toolbar:"no",status:"no"},i=a["default"].defaults(n,r),u=a["default"].map(i,function(t,e){return e+"="+t}).toString();o.open(t,e,u)},document.addEventListener("DOMContentLoaded",function(){return i()}),document.addEventListener("page:load",function(t){i(t.data),l=location.href}),document.addEventListener("page:before-partial-replace",function(t){var e=t.data,n=!0,r=!1,o=undefined;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var a=i.value;s["default"].unbind(a)}}catch(t){r=!0,o=t}finally{try{!n&&u["return"]&&u["return"]()}finally{if(r)throw o}}}),document.addEventListener("page:after-node-removed",function(t){return(0,u["default"])(t.data).remove()}),(0,u["default"])(document).ajaxComplete(function(){return s["default"].refresh()}),window.Page=null!=r["default"]?r["default"]:r});(function(){null==window.TurboGraft&&(window.TurboGraft={handlers:{}}),TurboGraft.tgAttribute=function(t){return"tg-"===t.slice(0,3)?"data-"+t:"data-tg-"+t},TurboGraft.getTGAttribute=function(t,e){var n;return n=TurboGraft.tgAttribute(e),t.getAttribute(n)||t.getAttribute(e)},TurboGraft.removeTGAttribute=function(t,e){var n;return n=TurboGraft.tgAttribute(e),t.removeAttribute(n),t.removeAttribute(e)},TurboGraft.hasTGAttribute=function(t,e){var n;return n=TurboGraft.tgAttribute(e),t.hasAttribute(n)||t.hasAttribute(e)},TurboGraft.querySelectorAllTGAttribute=function(t,e,n){var r;return null==n&&(n=null),r=TurboGraft.tgAttribute(e),n?t.querySelectorAll("["+r+"="+n+"], ["+e+"="+n+"]"):t.querySelectorAll("["+r+"], ["+e+"]")}}).call(this),function(){window.Click=function(){function t(t){this.event=t,this.event.defaultPrevented||(this._extractLink(),this._validForTurbolinks()&&(Turbolinks.visit(this.link.href),this.event.preventDefault()))}return t.installHandlerLast=function(e){if(!e.defaultPrevented)return document.removeEventListener("click",t.handle,!1),document.addEventListener("click",t.handle,!1)},t.handle=function(e){return new t(e)},t.prototype._extractLink=function(){var t;for(t=this.event.target;t.parentNode&&"A"!==t.nodeName;)t=t.parentNode;if("A"===t.nodeName&&0!==t.href.length)return this.link=new Link(t)},t.prototype._validForTurbolinks=function(){return null!=this.link&&!(this.link.shouldIgnore()||this._nonStandardClick())},t.prototype._nonStandardClick=function(){return this.event.which>1||this.event.metaKey||this.event.ctrlKey||this.event.shiftKey||this.event.altKey},t}()}.call(this),function(){window.ComponentUrl=function(){function t(e){if(this.original=null!=e?e:document.location.href,this.original.constructor===t)return this.original;this._parse()}return t.prototype.withoutHash=function(){return this.href.replace(this.hash,"")},t.prototype.withoutHashForIE10compatibility=function(){return this.withoutHash()},t.prototype.hasNoHash=function(){return 0===this.hash.length},t.prototype._parse=function(){var t;return(null!=this.link?this.link:this.link=document.createElement("a")).href=this.original,t=this.link,this.href=t.href,this.protocol=t.protocol,this.host=t.host,this.hostname=t.hostname,this.port=t.port,this.pathname=t.pathname,this.search=t.search,this.hash=t.hash,this.origin=[this.protocol,"//",this.hostname].join(""),0!==this.port.length&&(this.origin+=":"+this.port),this.relative=[this.pathname,this.search,this.hash].join(""),this.absolute=this.href},t}()}.call(this),function(){window.CSRFToken=function(){function t(){}return t.get=function(t){var e;return null==t&&(t=document),{node:e=t.querySelector('meta[name="csrf-token"]'),token:null!=e&&"function"==typeof e.getAttribute?e.getAttribute("content"):void 0}},t.update=function(t){var e;if(e=this.get(),null!=e.token&&null!=t&&e.token!==t)return e.node.setAttribute("content",t)},t}()}.call(this),function(){var t,e,n,r;e=function(t,e){return t.classList.contains(e)},n=function(t){return t.getAttribute("disabled")||e(t,"disabled")},r=function(t,e,n){var r,o;if(null==n&&(n=null),!(r=t.getAttribute("href")||t.getAttribute("action")))throw new Error("Turbograft developer error: You did not provide a URL ('"+urlAttribute+"' attribute) for data-tg-remote");return TurboGraft.getTGAttribute(t,"remote-once")&&(TurboGraft.removeTGAttribute(t,"remote-once"),TurboGraft.removeTGAttribute(t,"tg-remote")),o={httpRequestType:e,httpUrl:r,fullRefresh:null!=TurboGraft.getTGAttribute(t,"full-refresh"),refreshOnSuccess:TurboGraft.getTGAttribute(t,"refresh-on-success"),refreshOnSuccessExcept:TurboGraft.getTGAttribute(t,"full-refresh-on-success-except"),refreshOnError:TurboGraft.getTGAttribute(t,"refresh-on-error"),refreshOnErrorExcept:TurboGraft.getTGAttribute(t,"full-refresh-on-error-except")},new TurboGraft.Remote(o,n,t)},TurboGraft.handlers.remoteMethodHandler=function(t){var e,n,o;o=t.clickTarget,(e=TurboGraft.getTGAttribute(o,"tg-remote"))&&(t.preventDefault(),n=r(o,e),n.submit())},TurboGraft.handlers.remoteFormHandler=function(t){var e,n,o;o=t.target,e=o.getAttribute("method"),TurboGraft.hasTGAttribute(o,"tg-remote")&&(t.preventDefault(),n=r(o,e,o),n.submit())},t=function(t,e,r){return null==r&&(r=!1),document.addEventListener(t,function(t){var r,o;for(o=t.target;o!==document&&null!=o;){if(("A"===o.nodeName||"BUTTON"===o.nodeName)&&(r=n(o),r&&t.preventDefault(),!r))return t.clickTarget=o,void e(t);o=o.parentNode}})},t("click",TurboGraft.handlers.remoteMethodHandler,!0),document.addEventListener("submit",function(t){return TurboGraft.handlers.remoteFormHandler(t)})}.call(this),function(){var t=function(t,n){function r(){this.constructor=t}for(var o in n)e.call(n,o)&&(t[o]=n[o]);return r.prototype=n.prototype,t.prototype=new r,t.__super__=n.prototype,t},e={}.hasOwnProperty,n=[].slice;window.Link=function(e){function r(t){if(this.link=t,this.link.constructor===r)return this.link;this.original=this.link.href,r.__super__.constructor.apply(this,arguments)}return t(r,e),r.HTML_EXTENSIONS=["html"],r.allowExtensions=function(){var t,e,o,i;for(e=1<=arguments.length?n.call(arguments,0):[],o=0,i=e.length;o<i;o++)t=e[o],r.HTML_EXTENSIONS.push(t);return r.HTML_EXTENSIONS},r.prototype.shouldIgnore=function(){return this._crossOrigin()||this._anchored()||this._nonHtml()||this._optOut()||this._target()},r.prototype._crossOrigin=function(){return this.origin!==(new ComponentUrl).origin},r.prototype._anchored=function(){var t;return(this.hash&&this.withoutHash())===(t=new ComponentUrl).withoutHash()||this.href===t.href+"#"},r.prototype._nonHtml=function(){return this.pathname.match(/\.[a-z]+$/g)&&!this.pathname.match(new RegExp("\\.(?:"+r.HTML_EXTENSIONS.join("|")+")?$","g"))},r.prototype._optOut=function(){var t,e;for(e=this.link;!t&&e!==document&&null!==e;)t=null!=e.getAttribute("data-no-turbolink"),e=e.parentNode;return t},r.prototype._target=function(){return 0!==this.link.target.length},r}(ComponentUrl)}.call(this),function(){var t,e,n;window.Page||(window.Page={}),Page.visit=function(t,e){return null==e&&(e={}),e.reload?window.location=t:Turbolinks.visit(t)},Page.refresh=function(t,e){var n,r,o;return null==t&&(t={}),n=t.url?t.url:t.queryParams?(r=$.param(t.queryParams),r&&(r="?"+r),location.pathname+r):location.href,t.response?(t.partialReplace=!0,t.onLoadFunction=e,o=t.response,delete t.response,Turbolinks.loadPage(null,o,t)):(t.partialReplace=!0,e&&(t.callback=e),Turbolinks.visit(n,t))},Page.open=function(){return window.open.apply(window,arguments)},n=[],Page.onReplace=function(t,r){if(!t||!r)throw new Error("Page.onReplace: Node and callback must both be specified");if(!e(r))throw new Error("Page.onReplace: Callback must be a function");return n.push({node:t,callback:r})},e=function(t){return!!(t&&t.constructor&&t.call&&t.apply)},t=function(t,e){return t.contains?t.contains(e):!!(t===e||t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)},document.addEventListener("page:before-partial-replace",function(e){var r,o,i,u,a,s,l,c,f;for(c=e.data,f=[],i=0,a=n.length;i<a;i++){for(r=n[i],o=!1,u=0,s=c.length;u<s;u++)if(l=c[u],t(l,r.node)){r.callback(),o=!0;break}o||f.push(r)}return n=f}),document.addEventListener("page:before-replace",function(){var t,e,r;for(e=0,r=n.length;e<r;e++)t=n[e],t.callback();return n=[]})}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};TurboGraft.Remote=function(){function e(e,n,r){var o,i,u,a;this.opts=e,this.onError=t(this.onError,this),this.onSuccess=t(this.onSuccess,this),this.initiator=n||r,this.actualRequestType="get"===(null!=(i=this.opts.httpRequestType)?i.toLowerCase():void 0)?"GET":"POST",this.useNativeEncoding=this.opts.useNativeEncoding,this.formData=this.createPayload(n),this.opts.refreshOnSuccess&&(this.refreshOnSuccess=this.opts.refreshOnSuccess.split(" ")),this.opts.refreshOnSuccessExcept&&(this.refreshOnSuccessExcept=this.opts.refreshOnSuccessExcept.split(" ")),this.opts.refreshOnError&&(this.refreshOnError=this.opts.refreshOnError.split(" ")),this.opts.refreshOnErrorExcept&&(this.refreshOnErrorExcept=this.opts.refreshOnErrorExcept.split(" ")),a=new XMLHttpRequest,"GET"===this.actualRequestType?(u=this.formData?this.opts.httpUrl+"?"+this.formData:this.opts.httpUrl,a.open(this.actualRequestType,u,!0)):a.open(this.actualRequestType,this.opts.httpUrl,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),this.contentType&&a.setRequestHeader("Content-Type",this.contentType),a.setRequestHeader("X-XHR-Referer",document.location.href),o=CSRFToken.get().token,o&&a.setRequestHeader("X-CSRF-Token",o),triggerEventFor("turbograft:remote:init",this.initiator,{xhr:a,initiator:this.initiator}),a.addEventListener("loadstart",function(t){return function(){return triggerEventFor("turbograft:remote:start",t.initiator,{xhr:a})}}(this)),a.addEventListener("error",this.onError),a.addEventListener("load",function(t){return function(e){return a.status<400?t.onSuccess(e):t.onError(e)}}(this)),a.addEventListener("loadend",function(t){return function(){var e;return"function"==typeof(e=t.opts).done&&e.done(),triggerEventFor("turbograft:remote:always",t.initiator,{initiator:t.initiator,xhr:a})}}(this)),this.xhr=a}return e.prototype.submit=function(){return this.xhr.send(this.formData)},e.prototype.createPayload=function(t){var e;return e=t?this.useNativeEncoding||t.querySelectorAll("[type='file'][name]").length>0?this.nativeEncodeForm(t):this.uriEncodeForm(t):"",e instanceof FormData||(this.contentType="application/x-www-form-urlencoded; charset=UTF-8",-1===e.indexOf("_method")&&this.opts.httpRequestType&&"GET"!==this.actualRequestType&&(e=this.formAppend(e,"_method",this.opts.httpRequestType))),e},e.prototype.formAppend=function(t,e,n){return t.length&&(t+="&"),t+=encodeURIComponent(e)+"="+encodeURIComponent(n)},e.prototype.uriEncodeForm=function(t){var e;return e="",this._iterateOverFormInputs(t,function(t){return function(n){return e=t.formAppend(e,n.name,n.value)}}(this)),e},e.prototype.formDataAppend=function(t,e){var n,r,o,i;if("file"===e.type)for(i=e.files,r=0,o=i.length;r<o;r++)n=i[r],t.append(e.name,n);else t.append(e.name,e.value);return t},e.prototype.nativeEncodeForm=function(t){var e;return e=new FormData,this._iterateOverFormInputs(t,function(t){return function(n){return e=t.formDataAppend(e,n)}}(this)),e},e.prototype._iterateOverFormInputs=function(t,e){var n,r,o,i,u,a,s;for(i=this._enabledInputs(t),s=[],n=0,u=i.length;n<u;n++)r=i[n],o=!r.disabled,a="checkbox"===r.type||"radio"===r.type,o&&r.name&&(a&&r.checked||!a)?s.push(e(r)):s.push(void 0);return s},e.prototype._enabledInputs=function(t){var e,n,r,o,i,u,a,s,l,c,f;if(f="input:not([type='reset']):not([type='button']):not([type='submit']):not([type='image']), select, textarea",u=Array.prototype.slice.call(t.querySelectorAll(f)),n=Array.prototype.slice.call(TurboGraft.querySelectorAllTGAttribute(t,"tg-remote-noserialize")),!n.length)return u;for(e=n,o=0,s=n.length;o<s;o++)c=n[o],e=e.concat(Array.prototype.slice.call(c.querySelectorAll(f)));for(r=[],a=0,l=u.length;a<l;a++)i=u[a],e.indexOf(i)<0&&r.push(i);return r},e.prototype.onSuccess=function(t){var e,n,r;return"function"==typeof(e=this.opts).success&&e.success(),r=t.target,triggerEventFor("turbograft:remote:success",this.initiator,{initiator:this.initiator,xhr:r}),(n=r.getResponseHeader("X-Next-Redirect"))?void Page.visit(n,{reload:!0}):TurboGraft.hasTGAttribute(this.initiator,"tg-remote-norefresh")?void 0:this.opts.fullRefresh&&this.refreshOnSuccess?Page.refresh({onlyKeys:this.refreshOnSuccess}):this.opts.fullRefresh?Page.refresh():this.refreshOnSuccess?Page.refresh({response:r,onlyKeys:this.refreshOnSuccess}):this.refreshOnSuccessExcept?Page.refresh({response:r,exceptKeys:this.refreshOnSuccessExcept}):Page.refresh({response:r})},e.prototype.onError=function(t){var e,n;return"function"==typeof(e=this.opts).fail&&e.fail(),n=t.target,triggerEventFor("turbograft:remote:fail",this.initiator,{initiator:this.initiator,xhr:n}),TurboGraft.hasTGAttribute(this.initiator,"tg-remote-norefresh")?triggerEventFor("turbograft:remote:fail:unhandled",this.initiator,{xhr:n}):this.opts.fullRefresh&&this.refreshOnError?Page.refresh({onlyKeys:this.refreshOnError}):this.opts.fullRefresh?Page.refresh():this.refreshOnError?Page.refresh({response:n,onlyKeys:this.refreshOnError}):this.refreshOnErrorExcept?Page.refresh({response:n,exceptKeys:this.refreshOnErrorExcept}):triggerEventFor("turbograft:remote:fail:unhandled",this.initiator,{xhr:n})},e}()}.call(this),function(){var t,e,n,r,o,i,u,a,s,l,c,f,h,d,p,v=function(t,e){return function(){return t.apply(e,arguments)}};e="[data-turbolinks-track]",n="turbolinksTrack",t="true",f={},c=null,p=function(){var t;return t=Object.keys(f).map(function(t){return f[t]}),Promise.all(t)},window.TurboHead=function(){function e(t,e){this.activeDocument=t,this.upstreamDocument=e,this._insertNewAssets=v(this._insertNewAssets,this),this.activeAssets=u(this.activeDocument),this.upstreamAssets=u(this.upstreamDocument),this.newScripts=this.upstreamAssets.filter(r("nodeName","SCRIPT")).filter(s("src",this.activeAssets)),this.newLinks=this.upstreamAssets.filter(r("nodeName","LINK")).filter(s("href",this.activeAssets))}return e._testAPI={reset:function(){return f={},c=null}},e.prototype.hasChangedAnonymousAssets=function(){var e,r,i,u;return r=this.upstreamAssets.filter(o(n,t)),e=this.activeAssets.filter(o(n,t)),e.length!==r.length||(u=s("src",r),i=s("href",r),e.some(function(t){return u(t)||i(t)}))},e.prototype.hasNamedAssetConflicts=function(){return this.newScripts.concat(this.newLinks).filter(l(n,t)).some(i(n,this.activeAssets))},e.prototype.hasAssetConflicts=function(){return this.hasNamedAssetConflicts()||this.hasChangedAnonymousAssets()},e.prototype.waitForAssets=function(){return"function"==typeof c&&c({isCanceled:!0}),new Promise(function(t){return function(e){return c=e,p().then(t._insertNewAssets).then(p).then(e)}}(this))},e.prototype._insertNewAssets=function(){return h(this.activeDocument,this.newLinks),d(this.activeDocument,this.newScripts)},e}(),u=function(t){return[].slice.call(t.querySelectorAll(e))},r=function(t,e){return function(n){return n[t]===e}},s=function(t,e){return function(n){return!e.some(function(e){return n[t]===e[t]})}},o=function(t,e){return function(n){return n.dataset[t]===e}},l=function(t,e){return function(n){return n.dataset[t]!==e}},i=function(t,e){return function(n){var r;return r=n.dataset[t],e.some(o(t,r))}},h=function(t,e){return e.forEach(function(e){var n;return n=e.cloneNode(),t.head.appendChild(n),triggerEvent("page:after-link-inserted",n)})},d=function(t,e){var n;return n=Promise.resolve(),e.forEach(function(e){return n=n.then(function(){return a(t,e)})}),n},a=function(t,e){var n,r,o,i,u,a;if(a=e.src,f[a])return f[a];for(i=t.createElement("SCRIPT"),u=e.attributes,r=0,o=u.length;r<o;r++)n=u[r],i.setAttribute(n.name,n.value);return i.appendChild(t.createTextNode(e.innerHTML)),f[a]=new Promise(function(e){var n;return n=function(t){return"error"===t.type&&triggerEvent("page:#script-error",t),i.removeEventListener("load",n),i.removeEventListener("error",n),e()},i.addEventListener("load",n),i.addEventListener("error",n),t.head.appendChild(i),triggerEvent("page:after-script-inserted",i)})}}.call(this),function(){var t,e,n,r,o,i,u,a,s,l,c,f;f=null,o=function(){return document.addEventListener("DOMContentLoaded",function(){return triggerEvent("page:change"),triggerEvent("page:update")},!0)},i=function(){if("undefined"!=typeof jQuery)return jQuery(document).on("ajaxSuccess",function(t,e){if(jQuery.trim(e.responseText))return triggerEvent("page:update")})},r=void 0!==window.history.state||navigator.userAgent.match(/Firefox\/2[6|7]/),e=window.history&&window.history.pushState&&window.history.replaceState&&r,window.triggerEvent=function(t,e){var n;return n=document.createEvent("Events"),e&&(n.data=e),n.initEvent(t,!0,!0),document.dispatchEvent(n)},window.triggerEventFor=function(t,e,n){var r;return r=document.createEvent("Events"),n&&(r.data=n),r.initEvent(t,!0,!0),e.dispatchEvent(r)},u=function(t){var e,n;return n=(null!=(e=document.cookie.match(new RegExp(t+"=(\\w+)")))?e[1].toUpperCase():void 0)||"",document.cookie=t+"=; expires=Thu, 01-Jan-70 00:00:01 GMT; path=/",n},c="GET"===(a=u("request_method"))||""===a,n=e&&c,t=document.addEventListener&&document.createEvent,t&&(o(),i()),l=function(t,e){var n;return n=e.parentNode.replaceChild(t,e),triggerEvent("page:after-node-removed",n)},s=function(t){var e;return e=t.parentNode.removeChild(t),triggerEvent("page:after-node-removed",e)},window.Turbolinks=function(){function t(){}var e,r,o,i,u,a,c,h,d,p,v,g,m,b,y,w,T,E,A,x,S,k,G,C,P,O,L;return i=null,u=null,E=null,d=function(t,e){if(null==e&&(e={}),!y(t))return t=new ComponentUrl(t),G(),null==e.partialReplace&&(e.partialReplace=!1),null==e.onlyKeys&&(e.onlyKeys=[]),e.onLoadFunction=function(){return e.onlyKeys.length||P(),"function"==typeof e.callback?e.callback():void 0},p(t,e)},t.fullPageNavigate=function(t){return triggerEvent("page:before-full-refresh",{url:t}),document.location.href=t},t.pushState=function(t,e,n){return window.history.pushState(t,e,n)},t.replaceState=function(t,e,n){return window.history.replaceState(t,e,n)},p=function(e,n){var r,o,i;triggerEvent("page:fetch",{url:e.absolute}),null!=f&&(f.readyState=0,f.statusText="abort",f.abort()),f=new XMLHttpRequest,f.open("GET",e.withoutHashForIE10compatibility(),!0),f.setRequestHeader("Accept","text/html, application/xhtml+xml, application/xml"),f.setRequestHeader("X-XHR-Referer",E),null==n.headers&&(n.headers={}),o=n.headers;for(r in o)i=o[r],f.setRequestHeader(r,i);f.onload=function(){return f.status>=500?t.fullPageNavigate(e.absolute):t.loadPage(e,f,n),f=null},f.onerror=function(){return"abort"===f.statusText?void(f=null):t.fullPageNavigate(e.absolute)},f.send()},t.loadPage=function(e,n,r){var o,i;return null==r&&(r={}),triggerEvent("page:receive"),null==r.updatePushState&&(r.updatePushState=!0),(i=T(n))?r.partialReplace?(r.updatePushState&&A(e),L(i,n,r)):(o=new TurboHead(document,i),o.hasAssetConflicts()?t.fullPageNavigate(e.absolute):(r.updatePushState&&A(e),o.waitForAssets().then(function(t){if(!(null!=t?t.isCanceled:void 0))return L(i,n,r)}))):(triggerEvent("page:error",n),null!=e?t.fullPageNavigate(e.absolute):void 0)},L=function(t,e,n){var r,i;return r=o(null!=(i=t.querySelector("title"))?i.textContent:void 0,C(t.querySelector("body")),CSRFToken.get(t).token,"runScripts",n),n.updatePushState&&x(e),"function"==typeof n.onLoadFunction&&n.onLoadFunction(),triggerEvent("page:load",r)},o=function(t,n,r,o,i){var s,c;if(null==i&&(i={}),t&&(document.title=t),null==i.onlyKeys&&(i.onlyKeys=[]),null==i.exceptKeys&&(i.exceptKeys=[]),i.onlyKeys.length)return c=[].concat(g(),v(i.onlyKeys)),s=k(c,n),e(s)&&O(),s;k(g(),n),w(n),i.exceptKeys.length?S(i.exceptKeys,n):a(n),triggerEvent("page:before-replace"),l(n,document.body),null!=r&&CSRFToken.update(r),O(),o&&h(),u=window.history.state,triggerEvent("page:change"),triggerEvent("page:update")},v=function(t){var e,n,r,o,i,u,a,s;for(u=[],e=0,o=t.length;e<o;e++)for(r=t[e],s=TurboGraft.querySelectorAllTGAttribute(document,"refresh",r),n=0,i=s.length;n<i;n++)a=s[n],u.push(a);return u},g=function(){var t,e,n,r,o;for(n=[],o=TurboGraft.querySelectorAllTGAttribute(document,"refresh-always"),t=0,e=o.length;t<e;t++)r=o[t],n.push(r);return n},e=function(t){var e,n,r;for(e=0,n=t.length;e<n;e++)if(r=t[e],r.querySelectorAll("input[autofocus], textarea[autofocus]").length>0)return!0;return!1},O=function(){var t,e;if((t=(e=document.querySelectorAll("input[autofocus], textarea[autofocus]"))[e.length-1])&&document.activeElement!==t)return t.focus()},a=function(t){var e,n,r,o;for(o=TurboGraft.querySelectorAllTGAttribute(t,"refresh-never"),e=0,n=o.length;e<n;e++)r=o[e],s(r)},k=function(t,e){var n,r,o,i,u,a,f;for(triggerEvent("page:before-partial-replace",t),a=function(e){var n,r,o;for(n=0,r=t.length;n<r;n++)if(o=t[n],e!==o&&o.contains(e))return!0;return!1},f=[],r=0,o=t.length;r<o;r++)if(n=t[r],!a(n)){if(!(u=n.getAttribute("id")))throw new Error("Turbolinks refresh: Refresh key elements must have an id.");(i=e.querySelector("#"+u))?(i=i.cloneNode(!0),l(i,n),"SCRIPT"===i.nodeName&&"false"!==i.dataset.turbolinksEval?c(i):f.push(i)):TurboGraft.hasTGAttribute(n,"refresh-always")||s(n)}return f},b=function(t,e){var n,r,o,i,u,a;for(a=[],r=0,o=e.length;r<o;r++){if(n=e[r],!(i=n.getAttribute("id")))throw new Error("TurboGraft refresh: Kept nodes must have an id.");(u=t.querySelector("#"+i))?a.push(l(n,u)):a.push(void 0)}return a},w=function(t){var e,n,r,o,i;for(e=[],i=TurboGraft.querySelectorAllTGAttribute(document,"tg-static"),n=0,r=i.length;n<r;n++)o=i[n],e.push(o);b(t,e)},S=function(t,e){var n,r,o,i,u,a,s,l;for(n=[],r=0,u=t.length;r<u;r++)for(i=t[r],l=TurboGraft.querySelectorAllTGAttribute(document,"refresh",i),o=0,a=l.length;o<a;o++)s=l[o],n.push(s);b(e,n)},h=function(){var t,e,n,r,o
;for(o=Array.prototype.slice.call(document.body.querySelectorAll('script:not([data-turbolinks-eval="false"])')),t=0,e=o.length;t<e;t++)r=o[t],""!==(n=r.type)&&"text/javascript"!==n||c(r)},c=function(t){var e,n,r,o,i,u,a;for(n=document.createElement("script"),a=t.attributes,r=0,o=a.length;r<o;r++)e=a[r],n.setAttribute(e.name,e.value);n.appendChild(document.createTextNode(t.innerHTML)),u=t.parentNode,i=t.nextSibling,u.removeChild(t),u.insertBefore(n,i)},C=function(t){return t.innerHTML=t.innerHTML.replace(/<noscript[\S\s]*?<\/noscript>/gi,""),t},A=function(e){(e=new ComponentUrl(e)).absolute!==E&&t.pushState({turbolinks:!0,url:e.absolute},"",e.absolute)},x=function(e){var n,r;(n=e.getResponseHeader("X-XHR-Redirected-To"))&&(n=new ComponentUrl(n),r=n.hasNoHash()?document.location.hash:"",t.replaceState(u,"",n.href+r))},G=function(){return E=document.location.href},t.rememberCurrentUrl=function(){return t.replaceState({turbolinks:!0,url:document.location.href},"",document.location.href)},t.rememberCurrentState=function(){return u=window.history.state},function(t){return window.scrollTo(t.positionX,t.positionY)},P=function(){return document.location.hash?document.location.href=document.location.href:window.scrollTo(0,0)},y=function(t){return!triggerEvent("page:before-change",t)},T=function(t){var e,n;if(e=function(){var e;return 422!==t.status&&(400<=(e=t.status)&&e<600)},n=function(){return t.getResponseHeader("Content-Type").match(/^(?:text\/html|application\/xhtml\+xml|application\/xml)(?:;|$)/)},!e()&&n())return i(t.responseText)},m=function(e){var n;if(null!=(n=e.state)?n.turbolinks:void 0)return t.visit(e.target.location.href)},r=function(t){return setTimeout(t,500)},i=function(t){var e;return/<(html|body)/i.test(t)?(e=document.documentElement.cloneNode(),e.innerHTML=t):(e=document.documentElement.cloneNode(!0),e.querySelector("body").innerHTML=t),e.head=e.querySelector("head"),e.body=e.querySelector("body"),e},n?(t.visit=d,t.rememberCurrentUrl(),t.rememberCurrentState(),document.addEventListener("click",Click.installHandlerLast,!0),r(function(){return window.addEventListener("popstate",m,!1)})):t.visit=function(t){return document.location.href=t},t}()}.call(this);t(function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=window.Turbograft,window.Turbograft=null!=e["default"]?e["default"]:e}),t(function(){"use strict";window.Bugsnag&&(window.Bugsnag.metaData.bundles.tnt=!0)})}();