!function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=6)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(e,n){this.options={},this.options=t.merge(e,n)}return t.merge=function(t,e){var n={};for(var r in t)n[r]=t[r];for(var r in e)n[r]=e[r];return n},t.flatten=function(e){var n=t.merge(e,{});return n.properties={},t.merge(n,e.properties)},t.isEqual=function(t,e){for(var n in t)if(t[n]!==e[n])return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0},t}();e.Integration=r},function(t,e,n){"use strict";function r(){return"https://v.shopify.com/"}function o(t){var e=[];for(var n in t)("number"==typeof t[n]||t[n])&&("object"==typeof t[n]&&0===Object.keys(t[n]).length||e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n])));return e.join("&")}function i(t){var e=new Image(1,1);return e.src=t,e.style.display="none",e}function a(t,e,n){return i(r()+t+"/"+e+"?"+o(n))}function s(t,e){return a("internal_errors","page",{name:t.name,line:t.lineNumber||t.line,script:t.fileName||t.sourceURL||t.script,stack:t.stackTrace||t.stack||t.description,message:t.message,url:window.location,context:void 0!==e?e:null})}Object.defineProperty(e,"__esModule",{value:!0}),e.base=r,e.queryString=o,e.img=i,e.load=a,e.internalError=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(11);e.exportVar="analytics",e.trekkieClass=r.Trekkie,e.enabledIntegrations=[];var o=n(8);e.enabledIntegrations.push(["LastShop",o.LastShop]);var i=n(9);e.enabledIntegrations.push(["Performance",i.Performance]);var a=n(7);e.enabledIntegrations.push(["Clickstream",a.Clickstream]);var s=n(10);e.enabledIntegrations.push(["Session Attribution",s.SessionAttribution])},function(t,e,n){"use strict";function r(t){return e.cookie.read(t)}function o(t,e,n){void 0===n&&(n={}),a(t,e,n.permanent,i(window.location.hostname)),a(t,e,n.permanent,f),a(t,e,n.permanent,n.domain),a(t,e,n.permanent,"")}function i(t){var e=t.indexOf(c);return 0===e?"."+t:e>0?t.slice(e-1):p}function a(t,n,r,o){var i={maxage:r?u:s,domain:o,path:"/"};e.cookie.write(t,n,i)}Object.defineProperty(e,"__esModule",{value:!0});var s=18e5,u=62208e6,c="shopify",p=".shopify.com",f=".myshopify.com";e.cookie={parse:function(t){for(var e={},n=0,r=t.split(/ *; */);n<r.length;n++){var o=r[n],i=o.split("=");try{e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}catch(t){}}return e},read:function(t){if(e.cookie.enabled())return e.cookie.parse(document.cookie)[t]},write:function(t,n,r){if(void 0===r&&(r={}),e.cookie.enabled()){var o=encodeURIComponent(t)+"="+encodeURIComponent(n);return r.maxage&&(r.expires=new Date(Date.now()+r.maxage)),r.path&&(o+="; path="+r.path),r.domain&&(o+="; domain="+r.domain),r.expires&&(o+="; expires="+r.expires.toUTCString()),r.secure&&(o+="; secure"),document.cookie=o,o}},clear:function(t,n){return void 0===n&&(n={}),n.maxage=-1,e.cookie.write(t,"",n)},enabled:function(){try{return void 0!==document.cookie&&window.navigator.cookieEnabled}catch(t){return!1}}},e.read=r,e.write=o,e.shopifyCookieDomain=i},function(t,e,n){"use strict";function r(){return!!p.read(e.shortTermKey)||!!p.read(e.deprecatedShortTermKey)}function o(){return!!p.read(e.longTermKey)||!!p.read(e.deprecatedLongTermKey)}function i(){return d.fetchOrSet(!1,e.deprecatedShortTermKey,e.shortTermKey)}function a(){return d.fetchOrSet(!0,e.deprecatedLongTermKey,e.longTermKey)}function s(){return d.build()}function u(){return m.fetchOrSet(e.firstSeenKey)}function c(){return d.hexTime()}Object.defineProperty(e,"__esModule",{value:!0});var p=n(3);e.deprecatedShortTermKey="_s",e.shortTermKey="_shopify_s",e.deprecatedLongTermKey="_y",e.longTermKey="_shopify_y",e.firstSeenKey="_shopify_fs";var f="00000000",l="xxxx-4xxx-xxxx-xxxxxxxxxxxx",d={fetch:function(t){return p.read(t)},fetchOrSet:function(t,e,n){if(!p.cookie.enabled())return"00000000-0000-0000-4000-000000000000";var r=d.fetch(n)||d.fetch(e)||d.build(),o={permanent:t};return p.write(e,r,o),p.write(n,r,o),r},build:function(){var t="";try{var e=window.crypto||window.msCrypto,n=new Uint16Array(31);e.getRandomValues(n);var r=0;t=l.replace(/[x]/g,function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];var i=n[r]%16,a="x"===t?i:3&i|8;return r++,a.toString(16)}).toUpperCase()}catch(e){t=l.replace(/[x]/g,function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r=16*Math.random()|0;return("x"===t?r:3&r|8).toString(16)}).toUpperCase()}return d.hexTime()+"-"+t},hexTime:function(){var t=0,e=0;try{t=Date.now()>>>0}catch(e){t=(new Date).getTime()>>>0}try{e=performance.now()>>>0}catch(t){e=0}var n=Math.abs(t+e).toString(16).toLowerCase();return f.substr(0,8-n.length)+n}},m={fetch:function(t){return p.read(t)},fetchOrSet:function(t){var n=m.fetch(t)||(new Date).toJSON(),r={permanent:!0};return p.write(e.firstSeenKey,n,r),n}};e.hasShortTerm=r,e.hasLongTerm=o,e.shortTerm=i,e.longTerm=a,e.buildToken=s,e.firstSeen=u,e.hexTime=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0),o=n(2),i=n(1),a=function(){function t(t,e){this.integrations=[];var n=1+o.enabledIntegrations.length,r=this.waitFor(n,function(){try{e()}catch(t){i.internalError(t)}});this.trekkie=new o.trekkieClass(t.Trekkie,r),this.integrations.push(this.trekkie);for(var a=0,s=o.enabledIntegrations;a<s.length;a++){var u=s[a],c=t[u[0]],p=u[1];if(c&&"object"==typeof c)try{this.integrations.push(new p(c,this.trekkie,r))}catch(t){r(),i.internalError(t)}else r()}}return t.prototype.identify=function(t,e){void 0===t&&(t=""),void 0===e&&(e={});try{t instanceof Object&&(e=t,t="");for(var n=0,r=this.integrations;n<r.length;n++){r[n].identify({id:t,properties:e})}}catch(t){i.internalError(t)}},t.prototype.page=function(t,e){void 0===t&&(t=""),void 0===e&&(e={});try{t instanceof Object&&(e=t,t="");var n=this.pageDefaults();n.name=t,n.properties=r.Integration.merge(n.properties,e);for(var o=0,a=this.integrations;o<a.length;o++){a[o].page(n)}}catch(t){i.internalError(t)}},t.prototype.track=function(t,e){void 0===t&&(t=""),void 0===e&&(e={});try{t instanceof Object&&(e=t,t="");for(var n=0,r=this.integrations;n<r.length;n++){r[n].track({event:t,properties:e})}}catch(t){i.internalError(t)}},t.prototype.trackForm=function(t,e,n){var r=this;void 0===e&&(e=""),void 0===n&&(n={});try{t.addEventListener("submit",function(o){o.preventDefault(),r.track(e,n),setTimeout(function(){try{t.submit()}catch(t){i.internalError(t)}},0)})}catch(t){i.internalError(t)}},t.prototype.trackLink=function(t,e,n){var r=this;void 0===e&&(e=""),void 0===n&&(n={});try{t.addEventListener("click",function(o){var i=t.getAttribute("href")||t.getAttributeNS("http://www.w3.org/1999/xlink","href")||t.getAttribute("xlink:href");r.track(e,n),i&&"_blank"!==t.target&&!r.isMeta(o)&&(o.preventDefault(),setTimeout(function(){r.setLocation(i)},0))})}catch(t){i.internalError(t)}},t.prototype.isMeta=function(t){if(t instanceof KeyboardEvent&&(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey))return!0;if(t instanceof MouseEvent){var e=t.which,n=t.button;if(!e&&void 0!==n)return 1===n||2===n;if(2===e)return!0}return!1},t.prototype.setLocation=function(t){window.location.href=t},t.prototype.ready=function(t){setTimeout(t,0)},t.prototype.waitFor=function(t,e){return function(){--t>0||0===t&&setTimeout(e,0)}},t.prototype.pageDefaults=function(){var t=window.location.href,e=t.indexOf("?");return t=-1===e?"":t.slice(e),e=t.indexOf("#"),t=-1===e?t:t.slice(0,e),t="?"===t?"":t,{path:window.location.pathname,referrer:document.referrer,search:t,title:document.title,url:this.url(),properties:{}}},t.prototype.canonical=function(){for(var t=document.getElementsByTagName("link"),e=0;e<t.length;e++){var n=t[e];if("canonical"===n.getAttribute("rel"))return n.getAttribute("href")}return""},t.prototype.url=function(){var t=this.canonical();if(t)return t.indexOf("?")>0?t:t+window.location.search;var e=window.location.href,n=e.indexOf("#");return-1===n?e:e.slice(0,n)},t}();e.Tricorder=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(5),o=n(2),i=n(1);try{var a=window[o.exportVar].config;if(a)var s=window[o.exportVar],u=window.trekkie=new r.Tricorder(a,function(){window[o.exportVar]=u,window._visit={tag:function(){},multitrackToken:function(){return u.trekkie.defaultAttributes.uniqToken}},u.user=function(){return{traits:function(){return{uniqToken:u.trekkie.defaultAttributes.uniqToken}}}};for(var t=0,e=s;t<e.length;t++){var n=e[t],r=n[0];u[r]&&u[r].apply(u,n.slice(1))}})}catch(t){i.internalError(t)}},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(13),a=n(14),s=n(1),u=function(t){function e(e,n,r){var o=t.call(this,{},e)||this;o.requestType="clickstream",o.config={storageKey:"_trekkie_cs",eventName:"click",customEventName:"trekkie-clickstream",validTargets:["a","button","input","select"],validInputSubTypes:["submit","file","radio","checkbox","text","email","search","tel","url","password","number","range","button","reset"],safeInputSubTypes:["submit","radio","checkbox","button","reset"],appName:null,flushInterval:5},o.trekkie=n,o.config.appName=n.options.appName;var i=e.flushInterval;return void 0!==i&&"number"==typeof i&&(o.config.flushInterval=i),"iframe"===n.options.embedMode?o.clickQueue=o.createPostingQueue():o.clickQueue=o.createPersistedQueue(),o.flushClickEvents(),o.setClickListener(),o.setFlushInterval(),r(),o}return r(e,t),e.prototype.identify=function(t){},e.prototype.page=function(t){this.flushClickEvents()},e.prototype.track=function(t){var e=this;t.event===this.config.eventName&&setTimeout(function(){e.trekkie.emit(e.requestType,t)},0)},e.prototype.createPostingQueue=function(){return new a.PostingQueue(this.trekkie,this.requestType,this.config.eventName)},e.prototype.createPersistedQueue=function(){return new i.PersistedQueue(this.config.storageKey)},e.prototype.setFlushInterval=function(){var t=this;this.config.flushInterval>0&&setInterval(function(){t.flushClickEvents()},1e3*this.config.flushInterval)},e.prototype.flushClickEvents=function(){for(var t=0,e=this.clickQueue.all();t<e.length;t++){var n=e[t];this.track({event:this.config.eventName,properties:n})}this.clickQueue.clear()},e.prototype.setClickListener=function(){var t=this;document.documentElement.addEventListener("click",function(e){t.trackClick(e)},!0)},e.prototype.trackClick=function(t){try{if(this.shouldTrack(t)){var e=t.target,n={app_name:this.config.appName,url:window.location.href,target_text:this.getTextLabelFromHTMLElement(e),target_tagname:e.tagName,target_classname:this.getClassName(e),target_id:e.id,target_trekkie_context:this.getAdditionalContext(e),target_url:e.getAttribute("href"),target_form_input_type:this.isHTMLFormInputSubType(e)?e.type:null,target_form_action:this.isHTMLFormInputSubType(e)?this.getHTMLFormAction(e):null,target_form_relative_position:this.isHTMLFormInputSubType(e)?this.getFormRelativePosition(e):null};this.clickQueue.push(n);try{var r=this.trekkie.options,o={detail:n};"iframe"===r.embedMode&&r.embedParentOrigin?this.trekkie.getEmbedParent().postMessage(JSON.stringify({event:"trekkie:customEvent:v1",payload:{eventType:this.config.customEventName,data:o}}),r.embedParentOrigin):document.dispatchEvent(new CustomEvent(this.config.customEventName,o))}catch(t){}}}catch(t){s.internalError(t)}},e.prototype.getClassName=function(t){return"object"==typeof t.className?t.parentElement.getAttribute("class"):t.className},e.prototype.shouldTrack=function(t){var e=t.target.tagName;if(e)switch(e=e.toLowerCase(),this.config.validTargets[this.config.validTargets.indexOf(e)]){case void 0:return this.isAnyAncestorValidClickTarget(t.target);case"input":return this.config.validInputSubTypes.indexOf(t.target.type.toLowerCase())>=0;default:return!0}},e.prototype.isAnyAncestorValidClickTarget=function(t){for(;t.parentNode;)if(t=t.parentNode,t.tagName&&-1!==this.config.validTargets.indexOf(t.tagName.toLowerCase()))return!0;return!1},e.prototype.getTextLabelFromHTMLElement=function(t){switch(t.tagName.toLowerCase()){case"input":return this.config.safeInputSubTypes.indexOf(t.type)>-1?t.value:t.name;case"select":var e=t.options.selectedIndex;return e>-1?t.options[e].text:"No value chosen";default:return this.getTargetText(t)||this.getTextLabelFromParentHTMLElement(t)}},e.prototype.getTextLabelFromParentHTMLElement=function(t){for(;t.parentNode;)if(t=t.parentNode,t.tagName&&-1!==this.config.validTargets.indexOf(t.tagName.toLowerCase()))return this.getTargetText(t)},e.prototype.getTargetText=function(t){var e=t.innerText||t.textContent;if(e)return this.dedupTargetText(e.replace(/\s+/g," ").trim())},e.prototype.dedupTargetText=function(t){if(-1===t.indexOf(" "))return t;var e={};return t.split(" ").filter(function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}).join(" ")},e.prototype.getAdditionalContext=function(t){for(var e={};t.parentNode;){for(var n=0,r=Array.prototype.slice.call(t.attributes);n<r.length;n++){var o=r[n];o&&o.value&&o.name.match(/^data-trekkie-.*/)&&(e[o.name]=o.value)}t=t.parentNode}return Object.getOwnPropertyNames(e).length>0?JSON.stringify(e):null},e.prototype.getHTMLFormAction=function(t){for(;t.parentNode;)if((t=t.parentNode)&&t.tagName&&"form"===t.tagName.toLowerCase()){var e=t.attributes.getNamedItem("action");if(e&&e.value)return e.value}return""},e.prototype.isHTMLFormInputSubType=function(t){return-1!==["input","select"].indexOf(t.tagName.toLowerCase())},e.prototype.getFormRelativePosition=function(t){switch(t.tagName.toLowerCase()){case"select":return t.options.selectedIndex;default:return null}},e}(o.Integration);e.Clickstream=u},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(15),a=function(t){function e(e,n,r){var o=t.call(this,{},e)||this,a=encodeURIComponent(window.location.hostname);return i.script({src:"https://v.shopify.com/last_shop?shop="+a,className:"tricorder-lastshop"}),r(),o}return r(e,t),e.prototype.identify=function(t){},e.prototype.page=function(t){},e.prototype.track=function(t){},e}(o.Integration);e.LastShop=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=function(t){function e(n,r,o){var i=t.call(this,e.defaultOptions,n)||this;return i.trekkie=r,o(),i}return r(e,t),e.prototype.identify=function(t){},e.prototype.page=function(t){var e={event:"navigation_performance_metrics",properties:o.Integration.flatten(t)},n=this.options;n.navigationTimingApiMeasurementsEnabled&&n.navigationTimingApiMeasurementsSampleRate>=Math.random()&&(e.properties=o.Integration.merge(this.pagePerformance(),e.properties),this.trekkie.track(e))},e.prototype.track=function(t){},e.prototype.pagePerformance=function(){return(new a).collect()},e.defaultOptions={navigationTimingApiMeasurementsEnabled:!0,navigationTimingApiMeasurementsSampleRate:.001},e}(o.Integration);e.Performance=i;var a=function(){function t(){}return t.prototype.timing=function(){return!(!window.performance||!window.performance.timing)&&window.performance.timing},t.prototype.userAgent=function(){return window.navigator.userAgent},t.prototype.collect=function(){var e=this,n={},r=function(){for(var e=0,r=t.perfAttrs;e<r.length;e++){var o=r[e];n["nt:"+o]=0}n["nt:valid"]=!1};if(this.timing()&&!function(){return new RegExp("MSIE 9.0|Firefox/7.0|Firefox/8.0").test(e.userAgent())}())try{for(var o=0,i=t.perfAttrs;o<i.length;o++){var a=i[o];n["nt:"+a]=this.timing()[a]}n["nt:valid"]=!0}catch(t){r()}else r();return n},t.perfAttrs=["connectEnd","connectStart","domComplete","domContentLoadedEventEnd","domContentLoadedEventStart","domInteractive","domLoading","domainLookupEnd","domainLookupStart","fetchStart","loadEventEnd","loadEventStart","navigationStart","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","unloadEventEnd","unloadEventStart"],t}();e.PagePerformance=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),i=n(4),a=n(0);e.sessionAttributionEventKey="session-attribution",e.sessionAttributionParamsKey="_shopify_sa_p",e.sessionAttributionTimestampKey="_shopify_sa_t";var s=function(t){function n(e,n,r){var o=t.call(this,{},e)||this;return o.trekkie=n,o.timestampManager=new u,o.campaignManager=new c,setTimeout(function(){o.attributeSession()},0),r(),o}return r(n,t),n.prototype.identify=function(t){},n.prototype.page=function(t){},n.prototype.track=function(t){var n=this;t.event===e.sessionAttributionEventKey&&setTimeout(function(){n.trekkie.emit(e.sessionAttributionEventKey,t)},0)},n.prototype.attributeSession=function(){var t=new Date,n=window.location.search,r=this.campaignManager.constructCanonicalUtmString(n);this.timestampManager.isValid(t)&&this.campaignManager.isValid(r)||this.track({event:e.sessionAttributionEventKey,properties:{sa_url:window.location.href,sa_referrer:window.document.referrer,sa_utm_string:r,sa_token:i.buildToken()}}),this.timestampManager.extend(t.toJSON()),this.campaignManager.extend(r)},n}(a.Integration);e.SessionAttribution=s;var u=function(){function t(){}return t.prototype.fetch=function(){return o.read(e.sessionAttributionTimestampKey)},t.prototype.extend=function(t){o.write(e.sessionAttributionTimestampKey,t,{permanent:!1})},t.prototype.isValid=function(t){var e=this.fetch();if(!e)return!1;try{var n=new Date(e);if(n.getUTCDate()<t.getUTCDate())return!1;if(t.getTime()-n.getTime()>18e5)return!1}catch(t){return!1}return!0},t}();e.TimestampManager=u;var c=function(){function t(){}return t.prototype.fetch=function(){return o.read(e.sessionAttributionParamsKey)},t.prototype.extend=function(t){o.write(e.sessionAttributionParamsKey,t,{permanent:!1})},t.prototype.isValid=function(t){return""===t||this.fetch()===t},t.prototype.constructCanonicalUtmString=function(t){if(""===t||void 0===t||null===t)return"";t="?"===t[0]?t.slice(1):t;for(var e={},n=0,r=t.split("&");n<r.length;n++){var o=r[n],i=o.split("="),a=decodeURIComponent(i[0]),s=decodeURIComponent(i[1]);s&&a&&null!==a.match(/^utm_/)&&(e[a]=s)}var u="";return e.utm_source&&(u=this.appendToUtmString(u,"utm_source",e.utm_source)),e.utm_medium&&(u=this.appendToUtmString(u,"utm_medium",e.utm_medium)),e.utm_campaign&&(u=this.appendToUtmString(u,"utm_campaign",e.utm_campaign)),e.utm_term&&(u=this.appendToUtmString(u,"utm_term",e.utm_term)),e.utm_content&&(u=this.appendToUtmString(u,"utm_content",e.utm_content)),u},t.prototype.appendToUtmString=function(t,e,n){return(t=0===t.length?t:t+"&")+encodeURIComponent(e)+"="+encodeURIComponent(n)},t}();e.CampaignManager=c},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(0),i=n(1),a=n(4),s=function(t){function e(e,n){var r=t.call(this,{},e)||this,i="",s="",u="";return"iframe"!==e.embedMode&&(i=a.longTerm(),s=a.shortTerm(),u=a.firstSeen()),r.defaultAttributes={appName:e.appName,uniqToken:i,visitToken:s,microSessionId:a.buildToken(),microSessionCount:0,firstSeen:u},e.defaultAttributes&&(r.defaultAttributes=o.Integration.merge(e.defaultAttributes,r.defaultAttributes)),"parent"===e.embedMode&&r.installFrameListener(),n(),r}return r(e,t),e.prototype.identify=function(t){this.emit("identify",t)},e.prototype.page=function(t){e.isEqualPage(this.lastPage,t)||(this.lastPage=t,this.emit("page",t))},e.prototype.track=function(t){this.emit("track",t)},e.prototype.emit=function(t,e,n){void 0===n&&(n={});var r=this.options;n.microSessionCount||++this.defaultAttributes.microSessionCount,e=o.Integration.flatten(e);var a=o.Integration.merge(e,this.defaultAttributes);a.eventType=t,a=o.Integration.merge(a,n);var s=r.development?"testing":a.appName;if("iframe"===r.embedMode&&r.embedParentOrigin)try{this.getEmbedParent().postMessage(JSON.stringify({event:"trekkie:emit:v1",payload:{requestType:t,args:a,overrideAttributes:{microSessionId:a.microSessionId,microSessionCount:a.microSessionCount}}}),r.embedParentOrigin)}catch(t){i.internalError(t)}else i.load(s,t,a)},e.prototype.installFrameListener=function(){var t=this;window.addEventListener("message",function(e){t.handleEmbedEvent(e)})},e.prototype.handleEmbedEvent=function(t){try{if(t&&t.origin.match(/(shopify.com|shopifyapps.com|myshopify.io)$/)&&t.data){var e=JSON.parse(t.data);if(e.event&&e.event.match(/^trekkie:/))switch(e.event){case"trekkie:emit:v1":var n=e.payload;n&&n.requestType&&n.args&&this.emit(n.requestType,n.args,n.overrideAttributes);break;case"trekkie:customEvent:v1":var n=e.payload;n&&n.eventType&&document.dispatchEvent(new CustomEvent(n.eventType,n.data));break;case"trekkie:xtldToken:v1":case"trekkie:xtldLastShop:v1":break;default:!function(t,e){i.internalError(new Error,JSON.stringify(e))}(e.event,e)}}}catch(e){"SyntaxError"!==e.name&&i.internalError(e,JSON.stringify(t))}},e.prototype.getEmbedParent=function(){return window.top||window.parent},e.isEqualPage=function(t,e){return t&&e&&t.path===e.path&&t.referrer===e.referrer&&t.search===e.search&&t.title===e.title&&t.url===e.url&&t.name===e.name&&o.Integration.isEqual(t.properties,e.properties)},e}(o.Integration);e.Trekkie=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t){this.storageName=t,this.storage=localStorage,this.storageEnabled=this.checkLocalStorageAvailability()}return t.prototype.get=function(){return this.storageEnabled?this.storage.getItem(this.storageName):null},t.prototype.set=function(t){this.storageEnabled&&this.storage.setItem(this.storageName,t)},t.prototype.checkLocalStorageAvailability=function(){try{return this.storage.setItem("test","ok"),this.storage.removeItem("test"),!0}catch(t){return(22===t.code||1014===t.code)&&(this.storage.clear(),!0)}},t}();e.LocalStorage=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(12),o=function(){function t(t){this.queue=[],this.storage=new r.LocalStorage(t);var e=this.storage.get();null!==e&&(this.queue=JSON.parse(e))}return t.prototype.push=function(t){this.queue.push(t),this.persist()},t.prototype.all=function(){return this.queue},t.prototype.clear=function(){this.queue=[],this.persist()},t.prototype.persist=function(){this.storage.set(JSON.stringify(this.queue))},t}();e.PersistedQueue=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,n){this.trekkie=t,this.requestType=e,this.eventName=n}return t.prototype.push=function(t){this.trekkie.emit(this.requestType,{event:this.eventName,properties:t})},t.prototype.all=function(){return[]},t.prototype.clear=function(){},t}();e.PostingQueue=r},function(t,e,n){"use strict";function r(t){var e=document.createElement("script");return e.src=t.src,e.async=!0,t.onLoad&&i(e,t.onLoad),t.className&&(e.className=t.className),document.body.appendChild(e),e}function o(t){var e=document.createElement("iframe");return e.src=t.src,e.style.display="none",t.onLoad&&i(e,t.onLoad),t.className&&(e.className=t.className),document.body.appendChild(e),e}function i(t,e){return t.addEventListener("load",e,!1),t}Object.defineProperty(e,"__esModule",{value:!0}),e.script=r,e.iframe=o}]);